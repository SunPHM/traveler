	<!DOCTYPE html>
	<html>
	<head>
		<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
		<meta content="utf-8" http-equiv="encoding">
	  	<title>traveler</title>
		<link rel="stylesheet" type="text/css" href="css/tr.css">
	</head>

	<body>
		<div id="ThreeJS" style="position: absolute; left:0px; top:0px"></div>

		<!--javascript library -->
		<script src="js/three.js"></script>
		<script src="js/Detector.js"></script>
		<script src="js/d3.v3.min.js"></script>
	        <script src="js/d3.geo.projection.v0.min.js"></script>
	        <script src = "js/opentip-jquery.js"></script>

		<!--script main function -->
		<script>
			// ThreeJS global variables for rendering the scene
			var scene, camer, renderer;
			// ThreeJS variables for showing text, a plane facing towards the camera in 3-D space
			var canvas, context, texture, sprite;
			// when the mouse moves, call the given function
	      		document.addEventListener( 'mousemove', onDocumentMouseMove, false );
			// D3 variables for projecting the maps
			var projection, path, group;
			// init and animate
			initD3();
			initThreeJS();
			animate();
			//initD3();

			// init D3
			function initD3(){
				var width = window.innerWidth, height = window.innerHeight;
				// create a svg graphic to show the maps of countries
				var svg = d3.select("body").append("svg").attr("width",width).attr("height",height);
				// add a projection function to move certain map to the center of the html page
				projection = d3.geo.mercator().scale(width / 6).translate([width / 2, height / 2]);
				// the path function translates GEOJson objects into svg path data
				path = d3.geo.path().projection(projection);
				// tranform the GEOJson object into svg path data and display it into html
				d3.json("maps/NA.geo.json", function(data)
				{
					group = svg.append("g").attr("id","group");
					group.selectAll("path").data(data.features).enter().append("path").attr("d",path);

				});
			}

			// set the center map of D3
			function setCenterMap(country, project){
				var width = window.innerWidth, height = window.innerHeight;
        projection = eval("d3.geo."+project+"();");
        path = d3.geo.path().projection(projection);
        //projection = d3.geo.+project+().scale(width / 6).translate([width / 2, height / 2]);
				d3.json("maps/"+country+".geo.json", function(data)
				{
					var centroid = path.centroid(data),
					translate = projection.translate();
					projection.translate([translate[0] - centroid[0] + width / 2, translate[1] - centroid[1] + height / 2]);
					group.selectAll("path").data(data.features).enter().append("path").attr("d",path);
					group.selectAll("path").transition().duration(300).attr("d", path);
				});
			}

			//init threeJS
			function initThreeJS()
			{
				// scene
				scene = new THREE.Scene();
				// camera
				var width = window.innerWidth, height = window.innerHeight;
				var angle = 45, aspect = width / height, near = 0.1, far = 20000;
				camera = new THREE.PerspectiveCamera(angle, aspect, near, far);
				scene.add(camera);
				camera.position.set(0, 150, 400);
				camera.lookAt(scene.position);
				// renderer
				if ( Detector.webgl )
					renderer = new THREE.WebGLRenderer({antialias:true});
				else
					renderer = new THREE.CanvasRenderer();
				renderer.setSize(width, height);
				// set the ThreeJS scene in the same papge as the D3
				var container = document.getElementById('ThreeJS');
	      			container.appendChild( renderer.domElement );
				// canvas, context, texture, sprite
				canvas = document.createElement('canvas');
				canvas.width  = 400;
				canvas.height = 80;
	      			context = canvas.getContext('2d');
				//context.font = "Bold 20px Times ";
				//context.fillStyle = "rgba(0,0,0,1)";

				/*// Quadratric curves example
			    context.beginPath();
			    context.moveTo(75,25);
			    context.quadraticCurveTo(25,25,25,62.5);
			    context.quadraticCurveTo(25,100,50,100);
			    context.quadraticCurveTo(50,120,30,125);
			    context.quadraticCurveTo(60,120,65,100);
			    context.quadraticCurveTo(125,100,125,62.5);
			    context.quadraticCurveTo(125,25,75,25);
			    context.stroke();*/

				texture = new THREE.Texture(canvas);
				texture.needsUpdate = true;
				var spriteMaterial = new
					THREE.SpriteMaterial({map:texture, useScreenCoordinates:true, alignment:THREE.SpriteAlignment.topLeft});
				sprite = new THREE.Sprite(spriteMaterial);
				sprite.scale.set(300,100,1.0);
	      			sprite.position.set( 50, 50, 0 );
				scene.add(sprite);
			}

			// animate function using ThreeJS to render new interface
			function animate()
			{
				requestAnimationFrame(animate);
	  			renderer.render(scene, camera);
			}
			// A utility function to draw a rectangle with rounded corners.

			function roundedRect(context,x,y,width,height,radius,text,color){
			  context.beginPath();
			  context.moveTo(x,y+radius);
			  context.lineTo(x,y+height-radius);
			  context.quadraticCurveTo(x,y+height,x+radius,y+height);
			  context.lineTo(x+width-radius,y+height);
			  context.quadraticCurveTo(x+width,y+height,x+width,y+height-radius);
			  context.lineTo(x+width,y+radius);
			  context.quadraticCurveTo(x+width,y,x+width-radius,y);
			  context.lineTo(x+radius,y);
			  context.quadraticCurveTo(x,y,x,y+radius);
			  context.strokeStyle = color;
			  context.stroke();
			  context.fillStyle = color;
			  context.fill();
			  context.font="30px Georgia";
			  context.fillStyle = "white";
				context.fillText(text,10,25);
			}
			// capture mouse movement and update the ThreeJS scene
			function onDocumentMouseMove(event)
			{
				// update the mouse variable
				var mouse = {x:0, y:0};
				mouse.x = event.clientX;
				mouse.y = event.clientY;
				//console.log('mouse position captured: x = '  + mouse.x + ', y = ' + mouse.y);
				update(mouse);
			}

			// update the text to show at the mouse position
			function update(mouse){
				// x and y used for testing different languages
				var x = (mouse.x / window.innerWidth) * 2 - 1;
				var y = -(mouse.y / window.innerHeight) * 2 + 1;

				//Color of tool tip for different language
				var color = "black";

							// origin - English
	                        if(((x>=-0.3) && (x<=0.3)) && ((y>=-0.3)&&(y<=0.3))){
	                                setCenterMap("NA","mercator");
	                                message = "Two wrongs don't make a right";
	                                color = "#0000FF"; //Blue
	                        }
	                        // 1st quadrant - Chinese
	                        else if(((x>0.3) && (x<=0.6)) && ((y>=0) &&(y<=0.3))){
	                                setCenterMap("CHN","mercator");
	                                 message = "两个错误不能 make a right";
	                                 color = '#FF0000'; //Yellow
	                        }

	                        else if(((x>=0.6) && (x<=1)) && ((y>=0) &&(y<=0.3))){
	                                setCenterMap("CHN","cylindricalEqualArea");
	                                 message = "来得容易，去得快。";
	                                 color = '#FF0000'; //Yellow
	                        }

	                        else if(((x>=0.3) && (x<=1)) && ((y>=0) &&(y<=1))){
	                                setCenterMap("CHN","homolosine");
	                                 message = "Два заблуждения не 作出正确的";
	                                 color = '#FF0000'; //Yellow
	                        }
	                        // 2nd quadrant - Russian
                          else if(((x<=0.3) && (x>=-1) && (y<=1) && (y>=0)))
                          {
                                  setCenterMap("RUS","cylindricalEqualArea");
                                   message = "Два заблуждения не делают право";
                                   color = '#990066'; //Light Green
                          }
	                        else if(((x<=0.3) && (x>=-1) && (y<1) && (y>=0)))
	                        {
	                                setCenterMap("RUS","mercator");
	                                 message = "two заблуждения не делают right";
	                                 color = '#990066'; //Light Green
	                        }

	                        // 3rd quadrant - Hindi
	                        else if(((x<=1) && (x>=0)) && ((y>=-1) && (y<=0))){
	                                setCenterMap("IND","azimuthalEqualArea");
	                                 message = "आसान में आओ, आसान जाओ।";
	                                 color = '#FF9900'; //Blue
	                        }
	                        // 4th quadrant - Arabic
	                        else if(((x>=-1) && (x<=0)) && ((y>=-1) && (y<=0))){
	                                setCenterMap("ARA","mercator");
	                                 message = "ﺕﺄﺘﻳ ﻢﻧ ﺎﻠﺴﻬﻟ، ﻢﻧ ﺎﻠﺴﻬﻟ ﺎﻟﺬﻫﺎﺑ.";
	                                 color = '#006600';
	                        }
	                        else{
	                                 message = "test";
	                        }

				//Clear the textbox
				context.clearRect(0,0,640,480);
	            var metrics = context.measureText(message);
	            var width = metrics.width;
	            //Draw the textbox
	            roundedRect(context,x,y,width + 20,20+10,15,message,color);

	            texture.needsUpdate = true;
				// update the textbox position
				sprite.position.set(mouse.x, mouse.y - 20, 0 );
			}
		</script>
	</body>
	</html>
